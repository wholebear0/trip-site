<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Trip Gallery</title>

<style>
body {
    font-family: Arial, sans-serif;
    margin: 20px;
    background: #f5f5f5;
}

h1 {
    text-align: center;
    margin-bottom: 30px;
    text-transform: capitalize;
}

/* Gallery layout */
#gallery {
    display: flex;
    flex-direction: column;
    gap: 30px; /* more spacing */
    align-items: center;
}

/* Images */
#gallery img {
    width: 100%;          /* Bigger */
    max-width: 1000px;   /* ~20% larger than before */
    height: auto;
    object-fit: cover;
    border-radius: 0;    /* Square corners */
}

/* Back button */
#back-btn {
    display: block;
    margin: 40px auto;
    padding: 12px 24px;
    font-size: 16px;
    border-radius: 6px;
    border: none;
    background: #444;
    color: #fff;
    cursor: pointer;
    transition: 0.3s;
}
#back-btn:hover {
    background: #222;
}
</style>
</head>

<body>

<h1 id="trip-title">Loading...</h1>
<h2 id="miles">Loading...</h1>

<div id="gallery">Loading photos...</div>

<button id="back-btn" onclick="history.back()">‚Üê Back to Map</button>

<script>
const APPS_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwoUNNQZsKfLkEYcc4DfyVQkzuc3BGGXd-DDV0dAfMHhhE5i_FY3Bq5z8PBUhg2teot/exec"; // ‚Üê replace

const params = new URLSearchParams(window.location.search);
const slug = params.get("slug");

const gallery = document.getElementById("gallery");
const titleElem = document.getElementById("trip-title");

fetch(APPS_SCRIPT_URL)
  .then(res => res.json())
  .then(data => {

    const urls = data.images[slug] || [];
    titleElem.textContent = slug.replace(/-/g,' ');

    if(!urls.length){
      gallery.innerHTML = "<p>No photos for this trip.</p>";
      return;
    }

    gallery.innerHTML = "";

    urls.forEach(url => {

      // üöÄ ImageKit optimization for faster load
      let optimizedUrl = url;

      if(url.includes("imagekit.io")){
        const joinChar = url.includes("?") ? "&" : "?";
        optimizedUrl = url + joinChar + "tr=f-auto,q-70";
      }

      const img = document.createElement("img");
      img.src = optimizedUrl;
      img.alt = slug;

      // üöÄ Performance boosts
      img.loading = "lazy";
      img.decoding = "async";

      gallery.appendChild(img);
    });

  })
  .catch(err => {
    console.error(err);
    gallery.innerHTML = "<p>Failed to load photos.</p>";
  });
</script>

</body>
</html>
